---
- name: SSH - Prohibit empty passwords
  become: true
  lineinfile:
    path: /etc/ssh/sshd_config
    line: "PermitEmptyPasswords no"
    regexp: '^PermitEmptyPasswords '
    insertafter: '#PermitEmptyPasswords'
  notify: restart_ssh_server
- name: SSH - Enable Logging
  become: true
  lineinfile:
    path: /etc/ssh/sshd_config
    line: "LogLevel INFO"
    regexp: '^LogLevel '
    insertafter: '#LogLevel'
  notify: restart_ssh_server
- name: SSH - Enable Pubkey Authentication
  become: true
  lineinfile:
    path: /etc/ssh/sshd_config
    line: "PubkeyAuthentication yes"
    regexp: '^PubkeyAuthentication '
    insertafter: '#PubkeyAuthentication'
  notify: restart_ssh_server
- name: SSH - Disable root login
  become: true
  lineinfile:
    path: /etc/ssh/sshd_config
    line: "PermitRootLogin no"
    regexp: '^PermitRootLogin '
    insertafter: '#PermitRootLogin'
  notify: restart_ssh_server
